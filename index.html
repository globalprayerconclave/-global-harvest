<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GLOBAL HARVEST</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background: #f9fafb;
      color: #333;
    }

    header {
      background: purple;
      color: white;
      padding: 1rem 2rem;
      text-align: center;
    }

    header h1 {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 0;
      font-size: 1.9rem;
    }

    header img {
      height: 50px;
      border-radius: 8px;
    }

    header p {
      margin: 0.5rem 0 0 0;
      font-size: 0.8rem;
      font-weight: 100;
    }

    .about-us-button {
      background: purple;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: background 0.2s ease;
      margin-top: 1rem;
      float: right;
      margin-right: 1rem;
    }
    .about-us-button:hover { background: #6a0dad; }

    .daily-reflection-button {
      background: linear-gradient(to right, #0d9488, #20c997);
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.3s ease;
      margin-top: 1rem;
      float: right;
      margin-right: 1rem;
      box-shadow: 0 4px 8px rgba(13, 148, 136, 0.3);
    }
    .daily-reflection-button:hover {
      background: linear-gradient(to right, #20c997, #0d9488);
      box-shadow: 0 6px 12px rgba(32, 201, 151, 0.4);
      transform: translateY(-2px);
    }

    /* UPDATED: contemporary colors + typography for description ONLY (no layout changes) */
    .description {
      /* subtle layered gradient with soft violet/indigo accents */
      background:
        radial-gradient(1200px 280px at 0% 0%, rgba(124, 58, 237, 0.06), transparent 60%),
        radial-gradient(1000px 240px at 100% 100%, rgba(99, 102, 241, 0.06), transparent 60%),
        linear-gradient(180deg, #faf8ff 0%, #f6f7ff 100%);
      /* refined type (safe fallbacks) */
      font-family: "Inter", "Segoe UI", system-ui, -apple-system, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      color: #0f172a;   /* slate-900 */
      line-height: 1.7;
      /* preserve your original layout properties */
      text-align: justify;
      padding: 0.5rem;
      overflow: hidden;
    }
    .description h3 {
      margin: 0 0 0.25rem 0;
      font-weight: 800;
      letter-spacing: 0.02em;
      background-image: linear-gradient(90deg, #7c3aed, #2563eb); /* violet â†’ blue */
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent !important; /* overrides inline purple to show gradient text */
    }
    .description p {
      color: #334155;        /* slate-700 */
      font-size: 1.05rem;    /* subtle polish */
      letter-spacing: 0.1px; /* micro-tracking */
      text-align: justify;
      margin: 0 0 0.8rem 0;
    }
    .description a {
      color: #6d28d9; /* violet-700 */
      text-decoration: underline;
      text-underline-offset: 3px;
      text-decoration-thickness: 1.5px;
    }
    /* END description polish */

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
      background: #f1f5f9;
      padding: 1rem;
    }

    .controls input,
    .controls select {
      padding: 0.5rem;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      min-width: 200px;
    }

    /* UPDATED: Country list now displays vertically with better styling */
    .country-list {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      padding: 1rem;
      max-width: 800px;
      margin: 0 auto;
    }

    .country-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: white;
      border-radius: 10px;
      padding: 1rem 1.25rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      transition: all 0.3s ease;
      border-left: 4px solid #2563eb;
      cursor: pointer;
    }

    .country-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.12);
      background: #f8fafc;
    }

    .country-name {
      font-weight: 600;
      font-size: 1.1rem;
      color: #1e293b;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .country-flag {
      width: 24px;
      height: 16px;
      border-radius: 2px;
      object-fit: cover;
    }

    .country-time {
      background: #e0f2fe;
      color: #0369a1;
      padding: 0.4rem 0.8rem;
      border-radius: 6px;
      font-size: 0.9rem;
      font-weight: 500;
      min-width: 140px;
      text-align: center;
    }

    .topic-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: white;
      border-radius: 10px;
      padding: 1rem 1.25rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      transition: all 0.3s ease;
      border-left: 4px solid #0d9488;
      cursor: pointer;
    }

    .topic-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.12);
      background: #f0fdf4;
    }

    .topic-name {
      font-weight: 600;
      font-size: 1.1rem;
      color: #1e293b;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .topic-icon {
      font-size: 1.2rem;
    }

    .topic-time {
      background: #ccfbf1;
      color: #0d9488;
      padding: 0.4rem 0.8rem;
      border-radius: 6px;
      font-size: 0.9rem;
      font-weight: 500;
      min-width: 140px;
      text-align: center;
    }

    .no-results {
      text-align: center;
      padding: 2rem;
      color: #64748b;
      font-style: italic;
    }

    .alphabet-section {
      margin-top: 1.5rem;
      margin-bottom: 0.5rem;
    }

    .alphabet-header {
      font-size: 1.3rem;
      font-weight: 700;
      color: #7c3aed;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid #e2e8f0;
      margin-bottom: 0.5rem;
    }

    .day-section {
      margin-top: 2rem;
      margin-bottom: 1rem;
    }

    .day-header {
      font-size: 1.4rem;
      font-weight: 700;
      color: #7c3aed;
      padding: 0.75rem 1rem;
      background: linear-gradient(90deg, #f3e8ff, #e9d5ff);
      border-radius: 8px;
      margin-bottom: 1rem;
      border-left: 4px solid #7c3aed;
    }

    .time-slot {
      margin-bottom: 1.5rem;
      padding: 1rem;
      background: #f8fafc;
      border-radius: 8px;
    }

    .time-header {
      font-size: 1.1rem;
      font-weight: 600;
      color: #374151;
      margin-bottom: 0.75rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid #e5e7eb;
    }

    .country-details {
      max-width: 800px;
      margin: 1rem auto;
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .country-details h2 {
      margin-top: 0;
      color: #2563eb;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .country-details img {
      width: 40px;
      border-radius: 4px;
      border: 1px solid #ddd;
    }
    .info p { margin: 0.3rem 0; }

    .prayer-category {
      margin-top: 1rem;
      border: 1px solid #ddd;
      border-radius: 8px;
      overflow: hidden;
    }
    .prayer-category h3 {
      margin: 0;
      padding: 0.5rem 1rem;
      color: #1d4ed8;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      user-select: none;
      background: #f1f5f9;
    }
    .prayer-category h3 span { transition: transform 0.3s ease; display: inline-block; }
    .prayer-category ul {
      margin: 0;
      padding: 0.5rem 1.5rem;
      list-style: disc;
      display: none;
    }
    .prayer-category ul li { margin-bottom: 0.3rem; font-size: 1rem; color: #444; }

    .schedule-type {
      background: #f1f5f9;
      padding: 0.5rem 1rem;
      text-align: center;
      font-weight: bold;
      border-radius: 8px;
      margin: 0.5rem auto;
      max-width: 800px;
    }
    .topic-prayer { background: #e0f2fe; border-left: 4px solid #0284c7; }
    .country-prayer { background: #f0fdf4; border-left: 4px solid #16a34a; }

    .upcoming-prayers-container {
      display: flex;
      flex-wrap: wrap;
      overflow-x: visible;
      padding-bottom: 5px;
      animation: none;
      min-width: unset;
    }
    .upcoming-prayer-item {
      flex: 0 0 auto;
      padding: 0.3rem 0.8rem;
      margin-right: 0.5rem;
      margin-bottom: 0.5rem;
      background: #fff;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      white-space: nowrap;
      font-size: 0.9em;
    }
    #scrollingUpcoming { display: flex; animation: none; }
    .upcoming-prayers-wrapper { overflow: visible; white-space: normal; animation: none; }

    #aboutUsDetails {
      max-width: 800px;
      margin: 1rem auto;
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      display: none;
      animation: fadeIn 0.3s ease-out;
    }

    #dailyReflectionDetails {
      max-width: 800px;
      margin: 1.5rem auto;
      border-radius: 16px;
      padding: 2.5rem;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15), 0 0 15px rgba(255, 215, 0, 0.3);
      display: none;
      animation: fadeIn 0.3s ease-out;
      background: radial-gradient(circle at top left, #fffde7, #e0e6f8, #f8f0ff);
      color: #2d3748;
      border: 1px solid #ffebcd;
      position: relative;
      overflow: hidden;
    }
    #dailyReflectionDetails::before {
      content: '';
      position: absolute;
      top: -50px; left: -50px;
      width: 150%; height: 150%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
      opacity: 0.5; transform: rotate(20deg);
      pointer-events: none;
    }
    #aboutUsDetails h2, #dailyReflectionDetails h2 {
      margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 0.5rem; margin-bottom: 1rem;
    }
    #dailyReflectionDetails h2 {
      color: #6A0DAD; font-size: 1.5rem; text-align: center;
      border-bottom: 2px solid #FFD700; padding-bottom: 1rem; margin-bottom: 1.8rem;
      font-family: "Georgia", serif; text-shadow: 1px 1px 3px rgba(106, 13, 173, 0.2);
    }
    #aboutUsDetails p, #dailyReflectionDetails p { line-height: 1.6; margin-bottom: 1rem; }
    #dailyReflectionDetails p { font-size: 1.15rem; text-align: justify; color: #333333; margin-bottom: 1.2rem; }
    #dailyReflectionDetails p strong {
      color: #4C1D95; font-style: italic; font-weight: 700; display: block; margin-top: 0.5rem;
      font-size: 1.25rem; text-shadow: 0.5px 0.5px 2px rgba(76, 29, 149, 0.2);
    }

    #aboutUsDetails ul, #dailyReflectionDetails ul { list-style: none; padding: 0; margin-bottom: 1rem; }
    #aboutUsDetails ul li, #dailyReflectionDetails ul li { margin-bottom: 0.5rem; }
    #aboutUsDetails ul li a, #dailyReflectionDetails ul li a { color: #2563eb; text-decoration: none; }
    #aboutUsDetails ul li a:hover, #dailyReflectionDetails ul li a:hover { text-decoration: underline; }

    #aboutUsDetails .contact-info, #dailyReflectionDetails .contact-info {
      margin-top: 1.5rem; border-top: 1px solid #eee; padding-top: 1rem;
    }
    #dailyReflectionDetails .contact-info { border-top: 1px dashed #FFD700; padding-top: 1.5rem; margin-top: 2rem; }
    #aboutUsDetails .contact-info p, #dailyReflectionDetails .contact-info p {
      font-size: 0.9rem; color: #555; text-align: center;
    }
    #dailyReflectionDetails .contact-info p .emoji { font-size: 1.2em; vertical-align: middle; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .video-container {
      position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%;
      background: #000; margin-bottom: 1.5rem; border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2), 0 0 10px rgba(255, 215, 0, 0.2);
    }
    .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

    /* UPDATED: Contemporary styling for Immediate Prayer Needs */
    #urgentRequests {
      max-width: 800px;
      margin: 1rem auto;
      padding: 1.5rem;
      border-radius: 16px;
      background: 
        radial-gradient(600px 140px at 0% 0%, rgba(220, 38, 38, 0.08), transparent 70%),
        radial-gradient(600px 140px at 100% 100%, rgba(244, 63, 94, 0.08), transparent 70%),
        linear-gradient(180deg, #fff8f8 0%, #fff1f2 100%);
      border-left: 6px solid #dc2626;
      box-shadow: 
        0 6px 20px rgba(220, 38, 38, 0.12),
        0 0 0 1px rgba(220, 38, 38, 0.08);
      position: relative;
      overflow: hidden;
    }
    
    #urgentRequests::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.4) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.3) 0%, transparent 50%);
      pointer-events: none;
    }
    
    #urgentRequests h3 {
      margin: 0 0 1rem 0;
      color: #991b1b;
      font-size: 1.4rem;
      font-weight: 700;
      letter-spacing: -0.02em;
      position: relative;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    #urgentRequests h3::before {
      content: 'â—';
      font-size: 1.2em;
    }
    
    #urgentList {
      position: relative;
      z-index: 1;
    }
    
    #urgentList > div {
      margin-bottom: 1rem;
      padding: 1.25rem;
      background: rgba(255, 255, 255, 0.85);
      border-radius: 12px;
      border-left: 4px solid #ef4444;
      box-shadow: 
        0 2px 8px rgba(0, 0, 0, 0.05),
        0 1px 0 rgba(255, 255, 255, 0.8) inset;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }
    
    #urgentList > div:hover {
      transform: translateY(-2px);
      box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.08),
        0 1px 0 rgba(255, 255, 255, 0.8) inset;
    }
    
    #urgentList > div:last-child {
      margin-bottom: 0;
    }
    
    #urgentList strong {
      display: block;
      margin-bottom: 0.5rem;
      color: #dc2626;
      font-size: 1.1rem;
      font-weight: 600;
    }
    
    #urgentList div div {
      font-size: 0.95rem;
      color: #444;
      line-height: 1.5;
    }
    
    #urgentList a {
      display: inline-block;
      margin-top: 0.75rem;
      padding: 0.4rem 0.8rem;
      background: rgba(220, 38, 38, 0.1);
      color: #dc2626;
      text-decoration: none;
      border-radius: 6px;
      font-size: 0.9rem;
      font-weight: 500;
      transition: all 0.2s ease;
      border: 1px solid rgba(220, 38, 38, 0.2);
    }
    
    #urgentList a:hover {
      background: rgba(220, 38, 38, 0.15);
      text-decoration: none;
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(220, 38, 38, 0.2);
    }
    
    #urgentList a + a {
      margin-left: 0.5rem;
    }

    /* Palette helpers */ 
    :root{ 
      --gh-slate-900:#0f172a; 
      --gh-slate-700:#334155; 
      --gh-violet:#7c3aed; 
      --gh-indigo:#2563eb; 
      --gh-amber:#f59e0b; 
      --gh-rose:#dc2626; 
    } 
    
    /* Currently Praying: soft indigo/violet wash */
    .current-prayer{ 
      background: radial-gradient(500px 120px at 0% 0%, rgba(124,58,237,0.10), transparent 70%), radial-gradient(600px 140px at 100% 100%, rgba(37,99,235,0.10), transparent 70%), linear-gradient(180deg,#eef2ff 0%,#f5f3ff 100%) !important; 
      color:var(--gh-slate-900); 
      border-left:4px solid var(--gh-violet); 
      box-shadow:0 6px 20px rgba(79,70,229,0.12); 
    } 
    
    /* Upcoming: warm, subtle amber texture + refined chips */
    .upcoming-prayers{ 
      background: radial-gradient(600px 140px at 0% 100%, rgba(245,158,11,0.08), transparent 70%), radial-gradient(600px 140px at 100% 0%, rgba(251,191,36,0.08), transparent 70%), linear-gradient(180deg,#fffbeb 0%,#fff7ed 100%) !important; 
      border-left:4px solid var(--gh-amber); 
      box-shadow:0 6px 20px rgba(245,158,11,0.10); 
    } 
    
    .upcoming-prayer-item{ 
      background:linear-gradient(180deg,#ffffff 0%,#f8fafc 100%); 
      border:1px solid rgba(15,23,42,0.06); 
      box-shadow:0 1px 2px rgba(15,23,42,0.06); 
    } 
    
    /* Search area (controls): soft glassy panel and polished inputs */
    .controls{ 
      background: radial-gradient(700px 160px at 0% 0%, rgba(124,58,237,0.05), transparent 70%), radial-gradient(700px 160px at 100% 100%, rgba(37,99,235,0.05), transparent 70%), linear-gradient(180deg,#f8fafc 0%,#eef2ff 100%); 
      border-top:1px solid rgba(15,23,42,0.05); 
      border-bottom:1px solid rgba(15,23,42,0.05); 
    } 
    
    .controls input, .controls select{ 
      background:linear-gradient(180deg,#ffffff 0%,#f8fafc 100%); 
      border:1px solid rgba(99,102,241,0.25); 
      box-shadow: 0 1px 2px rgba(15,23,42,0.06), inset 0 1px 0 rgba(255,255,255,0.6); 
      color:var(--gh-slate-900); 
      transition:box-shadow .2s ease, border-color .2s ease, background .2s ease; 
    } 
    
    .controls input::placeholder{ 
      color:#64748b; 
    } 
    
    .controls input:focus, .controls select:focus{ 
      outline:none; 
      border-color:var(--gh-violet); 
      box-shadow: 0 0 0 3px rgba(124,58,237,0.20), 0 1px 2px rgba(15,23,42,0.06); 
      background:linear-gradient(180deg,#ffffff 0%,#f9fafb 100%); 
    }
  </style>
</head>
<body>
  <header>
    <h1>
      <img src="https://ik.imagekit.io/t2jnrvou6/WhatsApp%20Image%202025-09-08%20at%2021.20.14.jpeg" alt="Global Prayer Conclave Logo">
      GLOBAL HARVEST
    </h1>
    <p>IMPACTING THE NATIONS THROUGH THE GOSPEL OF JESUS CHRIST</p>
  </header>

  <section class="description">
    <h3 style="color: purple;">GLOBAL PRAYER CONCLAVE</h3>
    <p>Join Global Prayer Conclave for a dedicated 24-hour period of continuous prayer, strategically interceding for all the countries of the world through a structured, rotating schedule.</p>
    <p>This event unites believers globally to lift up specific nations, seeking God's transformative will and spiritual awakening across every land. Each hour provides an opportunity to connect with God and contribute to a powerful, global movement of targeted intercession.</p>
    <button id="dailyReflectionBtn" class="daily-reflection-button">Daily Bread: A Moment of Reflection</button>
    <button id="aboutUsBtn" class="about-us-button">About Us</button>
  </section>

  <div id="aboutUsDetails">
    <h2>GLOBAL HARVEST</h2>
    <h3 style="color: darkviolet;">Raising prayer for The Nations</h3>
    <strong>A Global movement: Standing in the Gap for Every Nation</strong>
    <p>Our intercessors are committed to covering every nation, every election, and every crisis in prayer. From Jerusalem to Damascus, Burkina Faso to Yangon, someone has always been standing in the gap for the nations and their people. As we move forward, our vision is to mobilize 10,000 intercessors worldwide to continue this journey of prayer. Together we will cover the world in prayer, believing that God will continue to move powerfully as men and women stand in the gap.</p>

    <h3 style="color: darkviolet;">Our Vision:</h3>
    <strong>RAISING 10,000 INTERCESSORS IN 193 COUNTRIES</strong>
    <p>Our vision is to raise 10,000 intercessors worldwide. This is a call for those who are passionate about seeing God's kingdom advance through prayer. We are looking for watchmen, prophetic intercessors, for revival and awakening. If you are one of them please sign up at <a href="https://tiny.cc/intercessor" target="_blank" rel="noopener noreferrer">tiny.cc/intercessor</a>.</p>

    <h3 style="color: darkviolet;">Upcoming Prayer conclaves</h3>
    <ul>
      <li><strong>Global Prayer Conclave: Dubai, UAE</strong> Date: September 2025.</li>
      <li><strong>Eurasia Prayer conclave : Moscow, Russia</strong> Date: TBD.</li>
      <li><strong>Prayer Mobilization across multiple nations and pastor's meetings :</strong> Planned locations include: Azerbaijan, USA, China, Indonesia, UAE, Iran, Kenya, India, and Others.</li>
      <li><strong>Special Events:</strong> Stay tuned to our social media channels for announcements!</li>
    </ul>

    <h3 style="color: darkviolet;">Meeting Links</h3>
    <ul>
      <li><a href="https://us02web.zoom.us/j/85784634655?pwd=NmdDTUhwckJ4dE9uTHMvbnBxOGN3UT09" target="_blank" rel="noopener">Join Us on Zoom</a></li>
    </ul>

    <h3 style="color: darkviolet;">GLOBAL PRAYER HUB - 24/7 INTERCESSION</h3>
    <p>If you have a heart for prayer and interceding for the nations, then the Prayer Hub in Dehradun is a place for you.</p>
    <p>A private place to pray is important if we want to have a quality prayer time. At the foothills of the Himalayas, the Global Prayer hub in Dehradun is created with the intention to help intercessors find a dedicated place to PRAY, STAY and spend quiet time with God.</p>
    <p>This is a strategic base for prayer and intercession, welcoming intercessors. The hub will also be a center for learning and training, with regular efforts to bring the local community together.</p>
    <p>The Hub is also an opportunity to meet other intercessors, opportunity to drive over the mountains of Uttarakhand and visit nearby places like Haridwar and Rishikesh.</p>
    <p>We welcome individuals and small groups for short stay.</p>
    <p>For details, please email us at: <a href="mailto:ghchurch@gmail.com?subject=Prayer%20Hub%20Inquiry&body=Hello%20Global%20Harvest%20Team%2C%0D%0A%0D%0AMy%20name%20is%20____.%20I%E2%80%99d%20like%20to%20inquire%20about%20the%20Prayer%20Hub.%0D%0A">ghchurch@gmail.com</a></p>

    <h3 style="color: darkviolet;">Stories From the ground!</h3>
    <strong>INDONESIA</strong>
    <p>We pray for Indonesia so that every man, woman, and child in Indonesia would hear the gospel of Jesus. There are still millions of Indonesians that do not know the truth about our Saviour. We invite you to join us in praying for Indonesia.</p>
    <p>Our intercessors and strong network of partner churches in Indonesia are growing. Across Central Kalimantan Island where 300 pastors came together in March 2025 for a two-day training and being equipped.</p>
    <p>Several evangelistic meetings were held across Indonesia in March 2025.</p>

    <strong>RUSSIA</strong>
    <p>The gospel continues to spread in Russia, with Christians finding ways to share their faith and experience growth. We have seen a huge surge in our prayer movement in Russia. The Global Harvest partner ministries among Russian and Armenian speakers has expanded. Our intercessors in Moscow and St. Petersburg pray around the clock for regional peace and revival in the CIS nations.</p>

    <h3 style="color: darkviolet;">One year Bible School</h3>
    <p>The Global Harvest School certificate of Theology Program, which aims to equip and train grassroot, is held for Hindi and Bengali speakers. We are working on providing this training in various other Indian languages and Indonesian.</p>

    <h3 style="color: darkviolet;">Be a Prayer and Mission partner!</h3>
    <p>As we continue to expand and mobilize prayer across the world, we need your support. Whether it's 1000 Rupees or 10,000 a month, your contribution makes a tremendous difference.</p>
    <p>Our estimated budget for the rest of the year 2025 is approximately 40 Lakhs Indian Rupees, and your prayerful giving will help sustain and grow this vital prayer ministry.</p>

    <h3 style="color: darkviolet;">Book a Prayer Slot</h3>
    <p>Interested in joining our prayer leadership, suggesting a nation/topic, or collaborating with us?</p>
    <ul>
      <li><a href="https://frolicking-biscotti-85feb1.netlify.app/" target="_blank" rel="noopener">Click to Book</a></li>
      <li>WhatsApp: <a href="https://wa.me/919910202164" target="_blank" rel="noopener">+91 9910 20 2164</a></li>
      <li><a href="mailto:globalprayerconclave@gmail.com?subject=Global%20Harvest%20Info%20Request&body=Hello%20Global%20Harvest%20Team%2C%0D%0A%0D%0AMy%20name%20is%20____.%20I%E2%80%99m%20reaching%20out%20for%20more%20information.%0D%0A">Email: globalprayerconclave@gmail.com</a></li>
    </ul>

    <div class="contact-info">
      <p>Follow us on Social Media!</p>
      <p>&#169; 2024 Global Prayer Conclave. All rights reserved.</p>
    </div>
  </div>

  <div id="dailyReflectionDetails">
    <h2>Daily Bread: A Moment of Reflection</h2>
    <p>The Old Testament is filled with inspiring and beautiful stories of men and women, which provide joy and depth. Each narrative reveals the mighty actions of the Lord, offering personal inspiration and a greater understanding of faith.</p>
    <p>
      "The narrative of Jacob wrestling with God in Genesis 32 highlights the complexity of Jacob's character, reflecting a life filled with struggle and conflict. From his birth, holding onto his brother Esau's heel, Jacob's existence has been marked by battles, culminating in this divine confrontation. This incident symbolizes Jacob's relentless pursuit of purpose and understanding of his faith."
      <br><strong>â€” Genesis 32:26 (NLT)</strong>
    </p>
    <p>Jacob's unwavering determination to receive God's blessings exemplifies perseverance and resilience. His declaration, "I will not leave you unless you bless me," reflects a deep hunger for God's love and a refusal to surrender, despite physical struggle. This story underscores that true determination in prayer can lead to profound outcomes, as God honors such relentless pursuit.</p>
    <p>Jacob's life teaches the importance of determination and perseverance in seeking God's mercy, especially in the quest for forgiveness. His loneliness led him to realize his need for God's grace, recognizing his guilt towards his brother Esau. Until that point, Jacob relied solely on his own strategies, but his encounter underscored the necessity of divine forgiveness.</p>
    <p>Jacob experiences profound loneliness after losing his support system, realizing that true companionship comes from God alone. In moments of isolation, we often learn that people may fail us, but it is God who remains steadfast and supportive through our darkest times. Trusting in God, especially during our lowest points, enables us to find strength and solace.</p>
    <p>Jacob's story illustrates the power of perseverance in seeking God's blessings, as demonstrated when he insists, 'I will not let you go unless you bless me.' He learns that true blessings come from God rather than through deceit, and his determination is evident in his commitment to work hard for Rachel. Ultimately, his struggles lead to God renaming him Israel, symbolizing his transformation through persistence.</p>
    <p>Through Jacob's struggle with God, he received a new identity as Israel, symbolizing the transformation that occurs when one is determined to seek God's touch and blessings. This message encourages listeners to seek their own new identities after facing shame and disappointment, with the promise that they will be lifted and blessed by God.</p>
    <p>God offers a new identity, transforming Jacob into Israel, and desires an intimate relationship with each of us. He encourages us to move beyond referring to Him through others like Abraham and Isaac, urging us to call Him 'my God' and embrace a personal connection. This closeness, built on humility and personal reflection, can profoundly impact our lives, just as Jacob's blessing did despite his limp.</p>
    <p>The dislocation of Jacob's hip symbolized his humility and deepened his relationship with God; rather than questioning God's actions, he accepted his pain with a joyful heart, recognizing the blessings that accompanied his struggles. This example from Jacob's life encourages us to embrace humility and seek an intimate, personal relationship with God, demonstrating determination even in hardship.</p>
    <p>ğ’¥ğ¼ğ‘€</p>
    <div class="video-container">
      <iframe width="560" height="315" src="https://www.youtube.com/embed/yVD9Pje2yVs?si=LFI0XBGRzcUn1Zkx" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    </div>
    <p style="margin-top: 1rem;">
      ğ“œğ“ªğ”‚ ğ”‚ğ“¸ğ“¾ğ“» ğ“±ğ“®ğ“ªğ“»ğ“½ ğ“«ğ“® ğ“¯ğ“²ğ“µğ“µğ“®ğ“­ ğ”€ğ“²ğ“½ğ“± ğ“¹ğ“®ğ“ªğ“¬ğ“® ğ“ªğ“·ğ“­ ğ“»ğ“®ğ“·ğ“®ğ”€ğ“®ğ“­ ğ“¼ğ“½ğ“»ğ“®ğ“·ğ“°ğ“½ğ“± ğ“ªğ“¼ ğ”‚ğ“¸ğ“¾ ğ”€ğ“ªğ“µğ“´ ğ”€ğ“²ğ“½ğ“± ğ“—ğ“²ğ“¶ ğ“½ğ“¸ğ“­ğ“ªğ”‚.
    </p>
    <div class="contact-info">
      <p>Blessings from the Global Harvest Team <span class="emoji">ğŸ™</span></p>
    </div>
  </div>

  <!-- Currently Praying + Upcoming -->
  <section class="current-prayer" id="currentPrayer" style="max-width:800px;margin:1rem auto;padding:0.75rem 1rem;background:#e0f2fe;border-radius:12px;font-weight:500;">
    Currently Praying: Loading...
  </section>

  <section class="upcoming-prayers" style="max-width:800px;margin:1rem auto;padding:0.5rem 1rem;background:#fef3c7;border-radius:12px;overflow:hidden;">
    <strong>Upcoming:</strong>
    <div class="upcoming-prayers-wrapper">
      <div id="scrollingUpcoming" class="upcoming-prayers-container">Loading upcoming prayers...</div>
    </div>
  </section>

  <!-- UPDATED: Immediate Prayer Needs with contemporary styling -->
  <section id="urgentRequests">
    <h3>Immediate Prayer Needs</h3>
    <div id="urgentList">Loading urgent requests...</div>
  </section>

  <section class="controls">
    <input type="text" id="searchBox" placeholder="Search country or topic..." />
    <select id="typeFilter">
      <option value="all">All Types</option>
      <option value="country">Countries</option>
      <option value="topic">Topics</option>
    </select>
    <select id="regionFilter">
      <option value="all">All Regions</option>
      <option value="Central Africa">Central Africa</option>
      <option value="Central Asia">Central Asia</option>
      <option value="East Africa">East Africa</option>
      <option value="East Asia">East Asia</option>
      <option value="Eastern Europe">Eastern Europe</option>
      <option value="North America">North America</option>
      <option value="Northern Europe">Northern Europe</option>
      <option value="Oceania">Oceania</option>
      <option value="South America">South America</option>
      <option value="South Asia">South Asia</option>
      <option value="Southeast Asia">Southeast Asia</option>
      <option value="Southern Africa">Southern Africa</option>
      <option value="Southern Europe">Southern Europe</option>
      <option value="West Africa">West Africa</option>
      <option value="West Asia">West Asia</option>
      <option value="Western Europe">Western Europe</option>
    </select>
    <select id="dayOfWeekFilter">
      <option value="all">All Days</option>
      <option value="Sunday">Sunday</option>
      <option value="Monday">Monday</option>
      <option value="Tuesday">Tuesday</option>
      <option value="Wednesday">Wednesday</option>
      <option value="Thursday">Thursday</option>
      <option value="Friday">Friday</option>
      <option value="Saturday">Saturday</option>
    </select>
  </section>

  <section class="country-list" id="countryList"></section>
  <section class="country-details" id="countryDetails" style="display:none;"></section>

  <!-- Urgent requests (static for now) -->
  <script>
    (function(){
      const urgentRequestsData = [
        {
          title: "Earthquake â€” Afghanistan",
          description: "A strong earthquake has affected communities. Pray for rescue teams, survivors, and relief efforts.",
          links: [
            { text: "Watch: Earthquake Hits Afghanistan", url: "https://www.youtube.com/watch?v=FLriPFyEe4A" },
            { text: "Read: Relief Updates", url: "https://example.com/earthquake-relief" }
          ]
        },
        {
          title: "Conflict / Displacement â€” [Example Country]",
          description: "Rising conflict has displaced families. Pray for peace, protection, and humanitarian access.",
          links: [
            { text: "Watch: Situation Update", url: "https://www.youtube.com/watch?v=EXAMPLE2" },
            { text: "Read: Humanitarian Report", url: "https://example.com/conflict-update" }
          ]
        }
      ];
      function renderUrgentRequests() {
        const container = document.getElementById('urgentList');
        if (!container) return;
        if (!urgentRequestsData || urgentRequestsData.length === 0) {
          container.innerHTML = "<p style='margin:0'>No urgent requests at this time.</p>";
          return;
        }
        container.innerHTML = urgentRequestsData.map(req => {
          const linksHtml = (req.links || []).map(l => {
            return `<a href="${l.url}" target="_blank" rel="noopener">${l.text}</a>`;
          }).join('');
          return `<div>
                    <strong>${req.title}</strong>
                    <div>${req.description}</div>
                    ${linksHtml}
                  </div>`;
        }).join('');
      }
      renderUrgentRequests();
    })();
  </script>

  <!-- moment.js + moment-timezone -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.43/moment-timezone-with-data.min.js"></script>

  <!-- Main app logic -->
  <script>
    // Now API-driven
    const prayerItems = []; // filled from API

    // UPDATED: Function to convert IST time to user's local time
    function convertISTtoLocal(dayOfWeek, startTime, durationMinutes = 60) {
      try {
        // Map day names to numbers (0=Sunday, 1=Monday, etc.)
        const dayMap = {
          "Sunday": 0, "Monday": 1, "Tuesday": 2, "Wednesday": 3,
          "Thursday": 4, "Friday": 5, "Saturday": 6
        };
        
        const targetDayIndex = dayMap[dayOfWeek];
        const [hour, minute] = startTime.split(':').map(Number);
        
        // Create moment in IST timezone for the scheduled time
        const now = moment.tz("Asia/Kolkata");
        let scheduledMomentIST = now.clone()
          .startOf('week')
          .add(targetDayIndex, 'days')
          .hour(hour)
          .minute(minute)
          .second(0)
          .millisecond(0);
        
        // Check if this time has already passed this week
        const scheduledEndMomentCandidate = scheduledMomentIST.clone().add(durationMinutes, 'minutes');
        if (scheduledEndMomentCandidate.isBefore(now)) {
          scheduledMomentIST.add(1, 'week');
        }
        
        // Convert to user's local timezone
        const localStart = scheduledMomentIST.clone().tz(moment.tz.guess());
        const localEnd = localStart.clone().add(durationMinutes, 'minutes');
        
        return {
          start: localStart,
          end: localEnd,
          displayTime: `${localStart.format("ddd, hh:mm A")} - ${localEnd.format("hh:mm A")}`,
          displayTimeWithZone: `${localStart.format("ddd, hh:mm A")} - ${localEnd.format("hh:mm A z")}`
        };
      } catch (e) {
        console.error("Error converting IST to local time:", e);
        return {
          start: moment(),
          end: moment().add(1, 'hour'),
          displayTime: "Time conversion error",
          displayTimeWithZone: "Time conversion error"
        };
      }
    }

    function parsePrayerSlot(item) {
      try {
        const { dayOfWeek, startTime, durationMinutes } = item;
        const timeConversion = convertISTtoLocal(dayOfWeek, startTime, durationMinutes || 60);
        return { 
          ...item, 
          startMoment: timeConversion.start, 
          endMoment: timeConversion.end 
        };
      } catch (e) {
        console.error("Error in parsePrayerSlot for item:", item?.name, e);
        const defaultStart = moment();
        return { ...item, startMoment: defaultStart, endMoment: defaultStart.clone().add(30, 'minutes') };
      }
    }

    const searchBox = document.getElementById("searchBox");
    const typeFilter = document.getElementById("typeFilter");
    const regionFilter = document.getElementById("regionFilter");
    const dayOfWeekFilter = document.getElementById("dayOfWeekFilter");
    const countryList = document.getElementById("countryList");
    const countryDetails = document.getElementById("countryDetails");
    const currentPrayer = document.getElementById("currentPrayer");
    const scrollingUpcoming = document.getElementById("scrollingUpcoming");

    let activeItemId = null;

    // UPDATED: Function to get display time in user's local timezone
    function getItemDisplayTime(item) {
      const timeConversion = convertISTtoLocal(item.dayOfWeek, item.startTime, item.durationMinutes || 60);
      return timeConversion.displayTime;
    }

    // UPDATED: Function to render items based on selected filter
    function renderItemList(data) {
      countryList.innerHTML = "";
      countryDetails.style.display = "none";
      
      if (!data || data.length === 0) {
        countryList.innerHTML = "<div class='no-results'>No items found matching your criteria.</div>";
        return;
      }

      const selectedDay = dayOfWeekFilter.value;
      const selectedType = typeFilter.value;

      // If a specific day is selected, show items grouped by time slots
      if (selectedDay !== "all") {
        renderDayView(data, selectedDay);
      } 
      // If countries are selected, show alphabetically
      else if (selectedType === "country" || (selectedType === "all" && selectedDay === "all")) {
        renderCountryView(data);
      }
      // For other cases, show simple list
      else {
        renderSimpleView(data);
      }
    }

    // Render day view with time slots
    function renderDayView(data, selectedDay) {
      const dayItems = data.filter(item => item.dayOfWeek === selectedDay);
      
      if (dayItems.length === 0) {
        countryList.innerHTML = `<div class='no-results'>No items scheduled for ${selectedDay}.</div>`;
        return;
      }

      // Sort by IST time (original schedule time) to maintain proper order
      dayItems.sort((a, b) => {
        const timeA = a.startTime || "00:00";
        const timeB = b.startTime || "00:00";
        return timeA.localeCompare(timeB);
      });

      const daySection = document.createElement('div');
      daySection.className = 'day-section';
      
      const dayHeader = document.createElement('div');
      dayHeader.className = 'day-header';
      dayHeader.textContent = `${selectedDay} Schedule (Displayed in your local time)`;
      daySection.appendChild(dayHeader);

      // Group by time slots (using local time for display)
      const timeSlots = {};
      dayItems.forEach(item => {
        const timeConversion = convertISTtoLocal(item.dayOfWeek, item.startTime, item.durationMinutes || 60);
        const timeKey = timeConversion.start.format("HH:mm"); // Use 24-hour format for grouping
        
        if (!timeSlots[timeKey]) {
          timeSlots[timeKey] = [];
        }
        timeSlots[timeKey].push(item);
      });

      // Render each time slot
      Object.keys(timeSlots).sort().forEach(timeKey => {
        const timeSlotDiv = document.createElement('div');
        timeSlotDiv.className = 'time-slot';
        
        const timeHeader = document.createElement('div');
        timeHeader.className = 'time-header';
        
        // Convert 24-hour format back to display format
        const timeMoment = moment(timeKey, "HH:mm");
        timeHeader.textContent = `ğŸ•’ ${timeMoment.format('hh:mm A')} (Your Local Time)`;
        
        timeSlotDiv.appendChild(timeHeader);

        // Render items in this time slot
        timeSlots[timeKey].forEach(item => {
          const timeConversion = convertISTtoLocal(item.dayOfWeek, item.startTime, item.durationMinutes || 60);
          
          const itemDiv = document.createElement('div');
          itemDiv.className = item.type === 'country' ? 'country-item' : 'topic-item';
          itemDiv.addEventListener('click', () => toggleItemDetails(item));
          
          const nameDiv = document.createElement('div');
          nameDiv.className = item.type === 'country' ? 'country-name' : 'topic-name';
          
          if (item.type === 'country' && item.flag) {
            const flagImg = document.createElement('img');
            flagImg.src = item.flag;
            flagImg.alt = `${item.name} flag`;
            flagImg.className = 'country-flag';
            nameDiv.appendChild(flagImg);
          } else if (item.type === 'topic' && item.icon) {
            const iconSpan = document.createElement('span');
            iconSpan.className = 'topic-icon';
            iconSpan.textContent = item.icon;
            nameDiv.appendChild(iconSpan);
          }
          
          nameDiv.appendChild(document.createTextNode(item.name));
          
          const timeDiv = document.createElement('div');
          timeDiv.className = item.type === 'country' ? 'country-time' : 'topic-time';
          timeDiv.textContent = timeConversion.displayTime;
          timeDiv.title = `Original IST time: ${item.dayOfWeek}, ${item.startTime}`;
          
          itemDiv.appendChild(nameDiv);
          itemDiv.appendChild(timeDiv);
          timeSlotDiv.appendChild(itemDiv);
        });

        daySection.appendChild(timeSlotDiv);
      });

      countryList.appendChild(daySection);
    }

    // Render country view alphabetically
    function renderCountryView(data) {
      const countries = data.filter(item => item.type === "country");
      
      if (countries.length === 0) {
        countryList.innerHTML = "<div class='no-results'>No countries found matching your criteria.</div>";
        return;
      }

      // Sort countries alphabetically
      countries.sort((a, b) => a.name.localeCompare(b.name));
      
      // Group by first letter
      const groupedCountries = {};
      countries.forEach(country => {
        const firstLetter = country.name.charAt(0).toUpperCase();
        if (!groupedCountries[firstLetter]) {
          groupedCountries[firstLetter] = [];
        }
        groupedCountries[firstLetter].push(country);
      });

      // Render alphabetically grouped countries
      Object.keys(groupedCountries).sort().forEach(letter => {
        const section = document.createElement('div');
        section.className = 'alphabet-section';
        
        const header = document.createElement('div');
        header.className = 'alphabet-header';
        header.textContent = letter;
        section.appendChild(header);
        
        groupedCountries[letter].forEach(item => {
          const timeConversion = convertISTtoLocal(item.dayOfWeek, item.startTime, item.durationMinutes || 60);
          
          const countryItem = document.createElement('div');
          countryItem.className = 'country-item';
          countryItem.addEventListener('click', () => toggleItemDetails(item));
          
          const nameDiv = document.createElement('div');
          nameDiv.className = 'country-name';
          if (item.flag) {
            const flagImg = document.createElement('img');
            flagImg.src = item.flag;
            flagImg.alt = `${item.name} flag`;
            flagImg.className = 'country-flag';
            nameDiv.appendChild(flagImg);
          }
          nameDiv.appendChild(document.createTextNode(item.name));
          
          const timeDiv = document.createElement('div');
          timeDiv.className = 'country-time';
          timeDiv.textContent = timeConversion.displayTime;
          timeDiv.title = `Original IST time: ${item.dayOfWeek}, ${item.startTime}`;
          
          countryItem.appendChild(nameDiv);
          countryItem.appendChild(timeDiv);
          section.appendChild(countryItem);
        });
        
        countryList.appendChild(section);
      });
    }

    // Render simple view for other cases
    function renderSimpleView(data) {
      data.forEach((item) => {
        const timeConversion = convertISTtoLocal(item.dayOfWeek, item.startTime, item.durationMinutes || 60);
        
        const itemDiv = document.createElement('div');
        itemDiv.className = item.type === 'country' ? 'country-item' : 'topic-item';
        itemDiv.addEventListener('click', () => toggleItemDetails(item));
        
        const nameDiv = document.createElement('div');
        nameDiv.className = item.type === 'country' ? 'country-name' : 'topic-name';
        
        if (item.type === 'country' && item.flag) {
          const flagImg = document.createElement('img');
          flagImg.src = item.flag;
          flagImg.alt = `${item.name} flag`;
          flagImg.className = 'country-flag';
          nameDiv.appendChild(flagImg);
        } else if (item.type === 'topic' && item.icon) {
          const iconSpan = document.createElement('span');
          iconSpan.className = 'topic-icon';
          iconSpan.textContent = item.icon;
          nameDiv.appendChild(iconSpan);
        }
        
        nameDiv.appendChild(document.createTextNode(item.name));
        
        const timeDiv = document.createElement('div');
        timeDiv.className = item.type === 'country' ? 'country-time' : 'topic-time';
        timeDiv.textContent = timeConversion.displayTime;
        timeDiv.title = `Original IST time: ${item.dayOfWeek}, ${item.startTime}`;
        
        itemDiv.appendChild(nameDiv);
        itemDiv.appendChild(timeDiv);
        countryList.appendChild(itemDiv);
      });
    }

    // UPDATED: Function to convert time for details view
    function convertISTtoLocalForDetails(dayOfWeek, startTime, durationMinutes) {
      const timeConversion = convertISTtoLocal(dayOfWeek, startTime, durationMinutes);
      return timeConversion.displayTimeWithZone;
    }

    function safe(val, fallback = "â€”") {
      return (val === undefined || val === null || val === "") ? fallback : val;
    }

    function toggleItemDetails(item) {
      if (activeItemId === item.name) {
        countryDetails.style.display = "none";
        activeItemId = null;
        return;
      }
      let detailsHTML = "";
      // UPDATED: Use local time conversion for details
      const prayerScheduleLocalDisplay = convertISTtoLocalForDetails(item.dayOfWeek, item.startTime, item.durationMinutes || 60);

      if (item.type === "country") {
        detailsHTML = `
          <div class="schedule-type country-prayer">Country Prayer Focus</div>
          <h2>${item.flag ? `<img src="${item.flag}" alt="flag"/>` : ""} ${safe(item.name)}</h2>
          <div class="info">
            <p><strong>Location:</strong> ${safe(item.location)}</p>
            <p><strong>Capital:</strong> ${safe(item.capital)}</p>
            <p><strong>Population:</strong> ${safe(item.population)}</p>
            <p><strong>Head of State:</strong> ${safe(item.headOfState)}</p>
            <p><strong>Official Language:</strong> ${safe(item.officialLanguage)}</p>
            <p><strong>Languages:</strong> ${safe(item.languages)}</p>
            <p><strong>People Groups:</strong> ${safe(item.peopleGroups)}</p>
            <p><strong>Least Reached People Groups:</strong> ${safe(item.leastReachedPeopleGroups)}</p>
            <p><strong>Largest Religion:</strong> ${safe(item.largestReligion)}</p>
            <p><strong>Christian Population:</strong> ${safe(item.christianPopulation)}</p>
            <p><strong>Prayer Slot (Your Local Time):</strong> ${prayerScheduleLocalDisplay}</p>
            <p><strong>Original IST Time:</strong> ${item.dayOfWeek}, ${item.startTime} IST</p>
            <p><strong>Region:</strong> ${safe(item.region)}</p>
          </div>
          <iframe 
            width="100%" height="300" style="border:0; border-radius:8px; margin-top:1rem;"
            src="https://www.google.com/maps?q=${encodeURIComponent(item.name)}&output=embed" 
            allowfullscreen loading="lazy">
          </iframe>
        `;
      } else {
        detailsHTML = `
          <div class="schedule-type topic-prayer">Topic Prayer Focus</div>
          <h2>${safe(item.icon, "ğŸ“Œ")} ${safe(item.name)}</h2>
          <div class="info">
            <p><strong>Description:</strong> ${safe(item.description, "â€”")}</p>
            <p><strong>Prayer Slot (Your Local Time):</strong> ${prayerScheduleLocalDisplay}</p>
            <p><strong>Original IST Time:</strong> ${item.dayOfWeek}, ${item.startTime} IST</p>
          </div>
        `;
      }

      if (Array.isArray(item.prayerPoints) && item.prayerPoints.length) {
        item.prayerPoints.forEach((pp) => {
          detailsHTML += `
            <div class="prayer-category">
              <h3>${safe(pp.category)} <span>&#9656;</span></h3>
              <ul>
                ${(pp.points || []).map(p => `<li>${p}</li>`).join("")}
              </ul>
            </div>
          `;
        });
      }

      countryDetails.innerHTML = detailsHTML;
      countryDetails.style.display = "block";
      countryDetails.scrollIntoView({ behavior: "smooth" });
      activeItemId = item.name;

      document.querySelectorAll(".prayer-category h3").forEach(h3 => {
        h3.onclick = () => {
          const ul = h3.nextElementSibling;
          const arrow = h3.querySelector("span");
          if (ul.style.display === "block") {
            ul.style.display = "none";
            arrow.style.transform = "rotate(0deg)";
          } else {
            ul.style.display = "block";
            arrow.style.transform = "rotate(90deg)";
          }
        };
      });
    }

    // Helper: has the user interacted with search/filters?
    function isUserFiltering() {
      return (
        (searchBox.value || "").trim().length > 0 ||
        typeFilter.value !== "all" ||
        regionFilter.value !== "all" ||
        dayOfWeekFilter.value !== "all"
      );
    }

    // Show nothing (just a hint) until the user interacts
    function filterItems() {
      if (!isUserFiltering()) {
        countryList.innerHTML = `
          <div class="no-results">
            Type in the search box or use the filters to see items.
          </div>`;
        countryDetails.style.display = "none";
        return;
      }

      const searchTerm = (searchBox.value || "").toLowerCase();
      const selectedType = typeFilter.value;
      const selectedRegion = regionFilter.value;
      const selectedDay = dayOfWeekFilter.value;

      const filtered = prayerItems.filter((item) => {
        const matchesType = selectedType === "all" || item.type === selectedType;
        const matchesRegion =
          selectedRegion === "all" ||
          (item.type === "country" && item.region === selectedRegion) ||
          item.type === "topic";
        const matchesDay = selectedDay === "all" || item.dayOfWeek === selectedDay;
        const matchesSearch =
          item.name.toLowerCase().includes(searchTerm) ||
          (item.description && item.description.toLowerCase().includes(searchTerm));
        return matchesType && matchesRegion && matchesDay && matchesSearch;
      });

      renderItemList(filtered);
    }

    searchBox.addEventListener("input", filterItems);
    typeFilter.addEventListener("change", filterItems);
    regionFilter.addEventListener("change", filterItems);
    dayOfWeekFilter.addEventListener("change", filterItems);

    function updatePrayerDisplay() {
      const now = moment();
      const allUpcomingPrayerSlots = prayerItems.map(item => parsePrayerSlot(item));
      const relevantSlots = allUpcomingPrayerSlots
        .filter(slot => slot.endMoment.isAfter(now))
        .sort((a, b) => a.startMoment - b.startMoment);

      const currentPrayers = [];
      let upcomingPrayers = [];

      relevantSlots.forEach(slot => {
        const isCurrentlyActive = now.isSameOrAfter(slot.startMoment) && now.isBefore(slot.endMoment);
        if (isCurrentlyActive) currentPrayers.push(slot);
      });

      if (currentPrayers.length > 0) {
        const currentPrayerNames = currentPrayers.map(item => {
          const typeLabel = item.type === "country" ? "" : (item.icon || "");
          return `${typeLabel} ${item.name}`.trim();
        }).join(', ');
        const latestCurrentEndTimeDisplay = currentPrayers.reduce((latest, item) => moment.max(latest, item.endMoment), now);
        currentPrayer.innerHTML = `<strong>Currently Praying:</strong> ${currentPrayerNames} (Until ${latestCurrentEndTimeDisplay.format("hh:mm A z")})`;
      } else {
        currentPrayer.innerHTML = "<strong>Currently Praying:</strong> No active prayer session";
      }

      upcomingPrayers = relevantSlots
        .filter(slot => slot.startMoment.isSame(now, 'day') && slot.startMoment.isAfter(now));

      if (upcomingPrayers.length > 0) {
        const upcomingHtml = upcomingPrayers.map(item => {
          const typeLabel = item.type === "country" ? "" : (item.icon || "");
          return `<div class="upcoming-prayer-item">${typeLabel} ${item.name} (${item.startMoment.format("ddd, hh:mm A")} - ${item.endMoment.format("hh:mm A z")})</div>`;
        }).join('');
        scrollingUpcoming.innerHTML = upcomingHtml;
      } else {
        scrollingUpcoming.innerHTML = `<div class="upcoming-prayer-item">No upcoming prayer sessions</div>`;
      }
    }

    // Initial: show hint, then schedule updates periodically
    filterItems();
    updatePrayerDisplay();
    setInterval(updatePrayerDisplay, 30000);
  </script>

  <!-- Load items from API and refresh UI -->
  <script>
    const API_ITEMS_URL = "https://prayer-api-go1t.onrender.com/api/items";
    async function loadItemsFromApi() {
      try {
        const list = document.getElementById("countryList");
        // Only show a loading message if the user already interacted
        if (list && isUserFiltering()) list.innerHTML = "<div class='no-results'>Loading itemsâ€¦</div>";

        const res = await fetch(API_ITEMS_URL, { cache: "no-store" });
        const data = await res.json();
        if (data.ok && Array.isArray(data.items)) {
          prayerItems.length = 0;
          prayerItems.push(...data.items);
          filterItems();         // will still show hint until user interacts
          updatePrayerDisplay(); // schedule continues to work
        } else {
          if (list && isUserFiltering()) list.innerHTML = "<div class='no-results'>Could not load items</div>";
          console.warn("Unexpected /api/items response:", data);
        }
      } catch (e) {
        const list = document.getElementById("countryList");
        if (list && isUserFiltering()) list.innerHTML = "<div class='no-results'>Failed to load items</div>";
        console.warn("Failed to load items:", e);
      }
    }
    loadItemsFromApi();
  </script>

  <!-- About Us and Daily Reflection toggle -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const aboutUsBtn = document.getElementById('aboutUsBtn');
      const aboutUsDetails = document.getElementById('aboutUsDetails');
      const dailyReflectionBtn = document.getElementById('dailyReflectionBtn'); 
      const dailyReflectionDetails = document.getElementById('dailyReflectionDetails');

      function toggleVisibility(button, detailsDiv) {
        if (detailsDiv.id === 'aboutUsDetails' && dailyReflectionDetails.style.display === 'block') {
          dailyReflectionDetails.style.display = 'none';
        } else if (detailsDiv.id === 'dailyReflectionDetails' && aboutUsDetails.style.display === 'block') {
          aboutUsDetails.style.display = 'none';
        }
        if (detailsDiv.style.display === 'none' || detailsDiv.style.display === '') {
          detailsDiv.style.display = 'block';
          detailsDiv.scrollIntoView({ behavior: "smooth", block: "start" });
        } else {
          detailsDiv.style.display = 'none';
        }
      }

      if (aboutUsBtn && aboutUsDetails) {
        aboutUsBtn.addEventListener('click', function() {
          toggleVisibility(aboutUsBtn, aboutUsDetails);
        });
      }
      if (dailyReflectionBtn && dailyReflectionDetails) {
        dailyReflectionBtn.addEventListener('click', function() {
          toggleVisibility(dailyReflectionBtn, dailyReflectionDetails);
        });
      }
    });
  </script>

  <!-- Backend status banner -->
  <script>
    const API_BASE = "https://prayer-api-go1t.onrender.com"; // Your Render URL

    function setBanner(text, bg, border) {
      let el = document.getElementById("backend-status");
      if (!el) {
        el = document.createElement("div");
        el.id = "backend-status";
        el.style.cssText =
          "max-width:800px;margin:0.5rem auto;padding:0.5rem 1rem;border-radius:8px;font-size:0.9rem;";
        document.querySelector('header').insertAdjacentElement('afterend', el);
      }
      el.style.background = bg;
      el.style.borderLeft = "4px solid " + border;
      el.style.color = "#111827";
      el.textContent = text;
    }

    setBanner("Checking backendâ€¦", "#eef2ff", "#6366f1");

    (async () => {
      try {
        const controller = new AbortController();
        const timeout = setTimeout(() => controller.abort(), 8000);
        const res = await fetch(API_BASE + "/api/health", {
          cache: "no-store",
          signal: controller.signal
        });
        clearTimeout(timeout);
        const data = await res.json();
        if (data && data.ok) {
          if (data.dbConnected) {
            setBanner("Backend: Online (DB connected)", "#ecfdf5", "#10b981");
          } else {
            setBanner("Backend: Online (DB not connected)", "#FEF9C3", "#F59E0B");
          }
        } else {
          setBanner("Backend: Online (unexpected response)", "#FEF3C7", "#F59E0B");
        }
      } catch (e) {
        console.warn("Backend check failed:", e);
        setBanner("Backend: Offline", "#fef2f2", "#ef4444");
      }
    })();
  </script>
</body>
</html>